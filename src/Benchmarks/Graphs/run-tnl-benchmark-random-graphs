#!/bin/bash

# Parameters
NUM_GRAPHS="1"
START_NODES="5"
NODES_INCREMENT="1"
START_EDGES="10"
EDGES_INCREMENT="10"
EDGE_WEIGHTS_DISTRIBUTION="normal"
BASE_FILE_NAME="random-graph"

# Python script name for generating graphs
GENERATE_GRAPH_SCRIPT="tnl-graph-generator.py"

# Loop to generate graphs and run the tnl-benchmark-graph program
for i in $(seq 1 $NUM_GRAPHS); do
   # Compute number of nodes and edges
   NODES=$((START_NODES + (i-1) * NODES_INCREMENT))
   EDGES=$((START_EDGES + (i-1) * EDGES_INCREMENT))

   FILE_NAME="${BASE_FILE_NAME}-${NODES}N-${EDGES}E.txt"

   # Generate graph
   echo "Generating graph with $NODES nodes and $EDGES edges int file $FILE_NAME ..."
   python $GENERATE_GRAPH_SCRIPT --nodes $NODES --edges $EDGES --edge-weights-distribution $EDGE_WEIGHTS_DISTRIBUTION --file-name $FILE_NAME

   # Call tnl-benchmark-graph program
   command="tnl-benchmark-graphs-dbg --input-file  $FILE_NAME --loops 0"
   echo $command
   eval $command

   if [[ -e "$FILE_NAME-boost-mst.txt" ]]; then
      graphs-graphviz.py --graph undirected --file-name $FILE_NAME-boost-mst.txt
   fi
   if [[ -e "$FILE_NAME-tnl-mst.txt" ]]; then
      graphs-graphviz.py --graph undirected --file-name $FILE_NAME-tnl-mst.txt
   fi

   graphs-graphviz.py --graph directed --file-name $FILE_NAME
   graphs-graphviz.py --graph undirected --file-name $FILE_NAME-undirected.txt
done
